<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Members Only</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/stylesheets/style.css">
        <link rel="stylesheet" href="/stylesheets/index.css">
    </head>
    <body>
        <div class="mainBodyContainer">
            <%- include("./partials/header") %>
            <% if(currentUser) { %>
                <div>Welcome, <%= currentUser.firstname %></div>
                <% if (currentUser.membership === 'member') { %>
                    <div>You are a member of the club!</div>
                <% } else { %>
                    <a href="/join">Join the club!</a>
                <% } %>
                <% if (currentUser.admin) { %>
                    <div>YOU ARE AN ADMIN</div>
                <% } %>
            <% } %>
            <% if (messages) { %>
                <% messages.forEach((message) => { %>
                    <div class="messageBox">
                        <div class="messageText"><%= message.text %></div>
                        <div class="messageDate">Published: <%= message.date %></div>
                        <% if (currentUser && currentUser.membership === 'member') { %>
                            <div class="messageAuthor">By: <%= message.author.firstname %></div>
                        <% } %>
                        <% if (currentUser && currentUser.admin) { %>
                            <form class="deleteMessage" method="post">
                                <button type="submit" name="messageId" value="<%= message.id %>">Delete</button>
                            </form>
                        <% } %>
                    </div>
                <% }) %>
            <% } else { %>
                <div>No messages!</div>
            <% } %>
        </div>
    </body>
</html>